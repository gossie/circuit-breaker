<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Circuit-breaker : ">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Circuit-breaker</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/gossie/circuit-breaker">View on GitHub</a>

          <h1 id="project_title">Circuit-breaker</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/gossie/circuit-breaker/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/gossie/circuit-breaker/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p><a href="https://travis-ci.org/gossie/circuit-breaker"><img src="https://travis-ci.org/gossie/circuit-breaker.svg?branch=master" alt="Build Status"></a>
<a href="https://coveralls.io/github/gossie/circuit-breaker?branch=master"><img src="https://coveralls.io/repos/github/gossie/circuit-breaker/badge.svg?branch=master" alt="Coverage Status"></a>
<a href="https://maven-badges.herokuapp.com/maven-central/com.github.gossie/circuit-breaker"><img src="https://maven-badges.herokuapp.com/maven-central/com.github.gossie/circuit-breaker/badge.svg" alt="Maven Central"></a>
<a href="http://javadoc-badge.appspot.com/com.github.gossie/circuit-breaker"><img src="http://javadoc-badge.appspot.com/com.github.gossie/circuit-breaker.svg?label=JavaDoc" alt="JavaDoc"></a></p>

<h1>
<a id="circuit-breaker" class="anchor" href="#circuit-breaker" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Circuit Breaker</h1>

<h2>
<a id="motivation-and-functionality" class="anchor" href="#motivation-and-functionality" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Motivation and functionality</h2>

<p>Let's suppose somewhere in your application there is a webservice call to retrieve some data from another system. If, for some reason, this webservice takes ages to respond or breaks down, you don't want your application to hang or break down as well. How does the CircuitBreaker help with that?<br>
The CirctuitBreaker intercepts each call to the method that calls the webservice. If the CircuitBreaker has the status CLOSED, it performs the actual method call.<br>
If a certain amount of calls were unsuccessful, that means an exception was caught or the call took to long, the CircuitBreaker will open up and stay open for a while. In that state every call to the webservice is rejected immediately, giving the webservice time to recover.<br>
After a certain amount of time, the CircuitBreaker will switch to the status HALF_OPEN. In that state the calls are forwarded to the webservice. If there is a failure, the CircuitBreaker will open up again. If a certain number of calls succeed the CircuitBreaker will close.</p>

<p>You can configure the following:</p>

<ul>
<li>
<em>errorTimeout</em>: How long the CircuitBreaker waits until the call is marked as unsuccessful</li>
<li>
<em>maxNumberOfSamples</em>: The state of the CurcuitBreaker refers to the last n calls, where n is the maxNumberOfSamples</li>
<li>
<em>maxErrorRation</em>: The percentage of tracked calls that has to fail until the CircuitBreaker opens up</li>
<li>
<em>openTimePeriod</em>: How long the CircuitBreaker stays open and reject calls</li>
</ul>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<p>To make use of a CircuitBreaker you just need to add a few annotation to your code and make some adjustments to your pom file.</p>

<h2>
<a id="sample-code" class="anchor" href="#sample-code" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sample code</h2>

<p>The CircuitBreaker class is ist an <a href="https://eclipse.org/aspectj/">AspectJ</a> <a href="https://github.com/Aspect" class="user-mention">@Aspect</a>. For each instance of a class annotated with @IntegrationPointConfiguration a CircuitBreaker instance is created. The CircuitBreaker intercepts all method calls of methods that are annotated with @IntegrationPoint.</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">@IntegrationPointConfiguration</span>(<span class="pl-c1">maxErrorRatio</span> <span class="pl-k">=</span> <span class="pl-c1">0.01</span>, <span class="pl-c1">openTimePeriod</span> <span class="pl-k">=</span> <span class="pl-c1">10000</span>, <span class="pl-c1">maxNumberOfSamples</span> <span class="pl-k">=</span> <span class="pl-c1">250</span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Client</span> {
    <span class="pl-k">private</span> <span class="pl-smi">WebService</span> service;

    <span class="pl-k">@IntegrationPoint</span>(<span class="pl-c1">errorTimeout</span> <span class="pl-k">=</span> <span class="pl-c1">1000</span>)
    <span class="pl-k">private</span> <span class="pl-smi">Result</span> <span class="pl-en">callService1</span>(<span class="pl-smi">Parameter</span> <span class="pl-v">p1</span>, <span class="pl-smi">Parameter</span> <span class="pl-v">p2</span>) {
        <span class="pl-k">return</span> service<span class="pl-k">.</span>performOperation1(p1, p2);
    }

    <span class="pl-k">@IntegrationPoint</span>(<span class="pl-c1">errorTimeout</span> <span class="pl-k">=</span> <span class="pl-c1">2000</span>)
    <span class="pl-k">private</span> <span class="pl-smi">Result</span> <span class="pl-en">callService2</span>(<span class="pl-smi">Parameter</span> <span class="pl-v">p3</span>) {
        <span class="pl-k">return</span> service<span class="pl-k">.</span>performOperation2(p3);
    }
}</pre></div>

<h3>
<a id="integration" class="anchor" href="#integration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Integration</h3>

<p>Add the circuit-breaker dependency to your project.</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">dependency</span>&gt;
  &lt;<span class="pl-ent">groupId</span>&gt;com.github.gossie&lt;/<span class="pl-ent">groupId</span>&gt;
  &lt;<span class="pl-ent">artifactId</span>&gt;circuit-breaker&lt;/<span class="pl-ent">artifactId</span>&gt;
  &lt;<span class="pl-ent">version</span>&gt;0.1.0&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre></div>

<p>Add the aspectj-maven-plugin to make sure that the CircuitBreaker aspect is weaved around your IntegrationPoints.</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">plugin</span>&gt;
  &lt;<span class="pl-ent">groupId</span>&gt;org.codehaus.mojo&lt;/<span class="pl-ent">groupId</span>&gt;
  &lt;<span class="pl-ent">artifactId</span>&gt;aspectj-maven-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
  &lt;<span class="pl-ent">version</span>&gt;1.9&lt;/<span class="pl-ent">version</span>&gt;
  &lt;<span class="pl-ent">configuration</span>&gt;
    &lt;<span class="pl-ent">complianceLevel</span>&gt;1.8&lt;/<span class="pl-ent">complianceLevel</span>&gt;
    &lt;<span class="pl-ent">weaveDependencies</span>&gt;
      &lt;<span class="pl-ent">weaveDependency</span>&gt;
        &lt;<span class="pl-ent">groupId</span>&gt;com.github.gossie&lt;/<span class="pl-ent">groupId</span>&gt;
        &lt;<span class="pl-ent">artifactId</span>&gt;circuit-breaker&lt;/<span class="pl-ent">artifactId</span>&gt;
      &lt;/<span class="pl-ent">weaveDependency</span>&gt;
    &lt;/<span class="pl-ent">weaveDependencies</span>&gt;
  &lt;/<span class="pl-ent">configuration</span>&gt;
  &lt;<span class="pl-ent">executions</span>&gt;
    &lt;<span class="pl-ent">execution</span>&gt;
      &lt;<span class="pl-ent">goals</span>&gt;
        &lt;<span class="pl-ent">goal</span>&gt;compile&lt;/<span class="pl-ent">goal</span>&gt;
      &lt;/<span class="pl-ent">goals</span>&gt;
    &lt;/<span class="pl-ent">execution</span>&gt;
  &lt;/<span class="pl-ent">executions</span>&gt;
&lt;/<span class="pl-ent">plugin</span>&gt;</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Circuit-breaker maintained by <a href="https://github.com/gossie">gossie</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
